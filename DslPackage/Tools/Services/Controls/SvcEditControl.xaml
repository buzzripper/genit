<local:UserControlBase x:Class="Dyvenix.GenIt.DslPackage.Tools.Services.Controls.SvcEditControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Dyvenix.GenIt.DslPackage.Tools.Services.Controls"
             xmlns:vsshell="clr-namespace:Microsoft.VisualStudio.Shell;assembly=Microsoft.VisualStudio.Shell.15.0"
             xmlns:platformui="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0"
             mc:Ignorable="d" 
             d:DesignHeight="500" d:DesignWidth="950"
             Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}">
    <UserControl.Resources>
        <!-- VS Theme-aware resources - define as local resources for child controls -->
        <SolidColorBrush x:Key="Theme.Background" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBackgroundKey}}"/>
        <SolidColorBrush x:Key="Theme.Background.Header" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBackgroundKey}}"/>
        <SolidColorBrush x:Key="Theme.Background.ToolBar" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBackgroundKey}}"/>
        <SolidColorBrush x:Key="Theme.Border" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBorderKey}}"/>
        <SolidColorBrush x:Key="Theme.Foreground" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowTextKey}}"/>
        <SolidColorBrush x:Key="Theme.HotTrack" Color="{DynamicResource {x:Static vsshell:VsColors.ControlLinkTextKey}}"/>
        <SolidColorBrush x:Key="Theme.Splitter" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBorderKey}}"/>
        <SolidColorBrush x:Key="Theme.DataGrid.Background" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBackgroundKey}}"/>
        <SolidColorBrush x:Key="Theme.DataGrid.RowBackground" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBackgroundKey}}"/>
        <SolidColorBrush x:Key="Theme.DataGrid.AlternatingRowBackground" Color="{DynamicResource {x:Static vsshell:VsColors.ToolWindowBackgroundKey}}"/>
        
        <!-- Implicit styles for controls -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
        </Style>
        
        <!-- TabControl with VS theming -->
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"/>
        </Style>
        
        <!-- TabItem with VS theming -->
        <Style TargetType="TabItem">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" 
                                Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"
                                BorderBrush="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"
                                BorderThickness="1,1,1,0"
                                Padding="8,4"
                                Margin="0,0,2,0">
                            <ContentPresenter x:Name="ContentSite"
                                              ContentSource="Header"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" 
                                        Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
                                <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
                                <Setter TargetName="Border" Property="Margin" Value="0,0,2,-1"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="False">
                                <Setter TargetName="Border" Property="Background" 
                                        Value="{DynamicResource {x:Static vsshell:VsBrushes.EnvironmentBackgroundKey}}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" 
                                        Value="{DynamicResource {x:Static vsshell:VsBrushes.CommandBarHoverKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- DataGrid with VS theming -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
            <Setter Property="RowBackground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="AlternatingRowBackground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"/>
        </Style>
        <Style TargetType="DataGridCell">
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
        </Style>
        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
        </Style>
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"/>
            <Setter Property="Padding" Value="4,2"/>
        </Style>
        
        <!-- Header style for grid section headers -->
        <Style x:Key="SectionHeaderBorder" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="4"/>
        </Style>
    </UserControl.Resources>
    
    <Grid Margin="4">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Top Row - Checkboxes and Options -->
        <Grid Grid.Row="0" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" Text="v1" VerticalAlignment="Center" Margin="4,0,12,0" FontSize="12"/>

            <CheckBox Grid.Column="1" x:Name="ckbInclCreate" Content="Include Create Method" 
                      VerticalAlignment="Center" Margin="0,0,16,0"
                      Checked="ckbInclCreate_Changed" Unchecked="ckbInclCreate_Changed"/>

            <CheckBox Grid.Column="2" x:Name="ckbInclUpdate" Content="Include Update Method" 
                      VerticalAlignment="Center" Margin="0,0,16,0"
                      Checked="ckbInclUpdate_Changed" Unchecked="ckbInclUpdate_Changed"/>

            <CheckBox Grid.Column="3" x:Name="ckbInclDelete" Content="Include Delete Method" 
                      VerticalAlignment="Center" Margin="0,0,16,0"
                      Checked="ckbInclDelete_Changed" Unchecked="ckbInclDelete_Changed"/>

            <CheckBox Grid.Column="4" x:Name="ckbInclController" Content="Include Controller" 
                      VerticalAlignment="Center" Margin="0,0,16,0"
                      Checked="ckbInclController_Changed" Unchecked="ckbInclController_Changed"/>

            <CheckBox Grid.Column="6" x:Name="ckbEnabled" Content="Enabled" 
                      VerticalAlignment="Center" HorizontalAlignment="Right"
                      Checked="ckbEnabled_Changed" Unchecked="ckbEnabled_Changed"/>
        </Grid>

        <!-- Tab Control with themed panel background -->
        <Border Grid.Row="1" Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBackgroundKey}}">
            <TabControl x:Name="tabControl">
                <TabItem Header="Read Methods">
                    <local:ReadMethodsEditControl x:Name="readMethodsEditCtl"/>
                </TabItem>
                <TabItem Header="Update Methods">
                    <local:UpdateMethodsEditControl x:Name="updMethodsEditCtl"/>
                </TabItem>
                <TabItem Header="Service" x:Name="tabService">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" MinWidth="150"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*" MinWidth="150"/>
                        </Grid.ColumnDefinitions>

                        <!-- Usings Grid -->
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Usings Header -->
                            <Border Grid.Row="0" Style="{StaticResource SectionHeaderBorder}">
                                <Grid>
                                    <TextBlock Text="Usings" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                    <Button x:Name="btnAddServiceUsing" ToolTip="Add Using" Click="btnAddServiceUsing_Click" 
                                            Padding="4" HorizontalAlignment="Right" Background="Transparent" BorderThickness="0">
                                        <TextBlock Text="+" FontSize="16" FontWeight="Bold"/>
                                    </Button>
                                </Grid>
                            </Border>

                            <DataGrid Grid.Row="1" 
                                      x:Name="grdServiceUsings"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      CanUserResizeRows="False"
                                      HeadersVisibility="None"
                                      GridLinesVisibility="None"
                                      SelectionMode="Single"
                                      SelectionUnit="FullRow"
                                      BorderThickness="0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Using" Width="*" Binding="{Binding Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTemplateColumn Header="" Width="40">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Click="btnDeleteServiceUsing_Click" 
                                                        Background="Transparent" BorderThickness="0" Cursor="Hand"
                                                        ToolTip="Delete">
                                                    <Path Data="M2,4 L5,4 L5,2 C5,1.45 5.45,1 6,1 L11,1 C11.55,1 12,1.45 12,2 L12,4 L15,4 L15,5 L14,5 L14,15 C14,15.55 13.55,16 13,16 L4,16 C3.45,16 3,15.55 3,15 L3,5 L2,5 L2,4 Z M6,4 L11,4 L11,2.5 L6,2.5 L6,4 Z M4,5 L4,15 L13,15 L13,5 L4,5 Z M5.5,7 L6.5,7 L6.5,13 L5.5,13 L5.5,7 Z M8,7 L9,7 L9,13 L8,13 L8,7 Z M10.5,7 L11.5,7 L11.5,13 L10.5,13 L10.5,7 Z" 
                                                          Fill="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}" 
                                                          Width="15" Height="15" Stretch="Uniform"/>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>

                        <!-- Splitter -->
                        <GridSplitter Grid.Column="1" Width="6" HorizontalAlignment="Center" VerticalAlignment="Stretch"
                                      Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"/>

                        <!-- Attributes Grid -->
                        <Grid Grid.Column="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Attributes Header -->
                            <Border Grid.Row="0" Style="{StaticResource SectionHeaderBorder}">
                                <Grid>
                                    <TextBlock Text="Attributes" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                    <Button x:Name="btnAddServiceAttribute" ToolTip="Add Attribute" Click="btnAddServiceAttribute_Click" 
                                            Padding="4" HorizontalAlignment="Right" Background="Transparent" BorderThickness="0">
                                        <TextBlock Text="+" FontSize="16" FontWeight="Bold"/>
                                    </Button>
                                </Grid>
                            </Border>

                            <DataGrid Grid.Row="1" 
                                      x:Name="grdServiceAttributes"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      CanUserResizeRows="False"
                                      HeadersVisibility="None"
                                      GridLinesVisibility="None"
                                      SelectionMode="Single"
                                      SelectionUnit="FullRow"
                                      BorderThickness="0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Attribute" Width="*" Binding="{Binding Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTemplateColumn Header="" Width="40">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Click="btnDeleteServiceAttribute_Click" 
                                                        Background="Transparent" BorderThickness="0" Cursor="Hand"
                                                        ToolTip="Delete">
                                                    <Path Data="M2,4 L5,4 L5,2 C5,1.45 5.45,1 6,1 L11,1 C11.55,1 12,1.45 12,2 L12,4 L15,4 L15,5 L14,5 L14,15 C14,15.55 13.55,16 13,16 L4,16 C3.45,16 3,15.55 3,15 L3,5 L2,5 L2,4 Z M6,4 L11,4 L11,2.5 L6,2.5 L6,4 Z M4,5 L4,15 L13,15 L13,5 L4,5 Z M5.5,7 L6.5,7 L6.5,13 L5.5,13 L5.5,7 Z M8,7 L9,7 L9,13 L8,13 L8,7 Z M10.5,7 L11.5,7 L11.5,13 L10.5,13 L10.5,7 Z" 
                                                          Fill="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}" 
                                                          Width="15" Height="15" Stretch="Uniform"/>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Grid>
                </TabItem>
                <TabItem Header="Controller" x:Name="tabController">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" MinWidth="150"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*" MinWidth="150"/>
                        </Grid.ColumnDefinitions>

                        <!-- Usings Grid -->
                        <Grid Grid.Column="0">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Usings Header -->
                            <Border Grid.Row="0" Style="{StaticResource SectionHeaderBorder}">
                                <Grid>
                                    <TextBlock Text="Usings" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                    <Button x:Name="btnAddControllerUsing" ToolTip="Add Using" Click="btnAddControllerUsing_Click" 
                                            Padding="4" HorizontalAlignment="Right" Background="Transparent" BorderThickness="0">
                                        <TextBlock Text="+" FontSize="16" FontWeight="Bold"/>
                                    </Button>
                                </Grid>
                            </Border>

                            <DataGrid Grid.Row="1" 
                                      x:Name="grdControllerUsings"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      CanUserResizeRows="False"
                                      HeadersVisibility="None"
                                      GridLinesVisibility="None"
                                      SelectionMode="Single"
                                      SelectionUnit="FullRow"
                                      BorderThickness="0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Using" Width="*" Binding="{Binding Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTemplateColumn Header="" Width="40">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Click="btnDeleteControllerUsing_Click" 
                                                        Background="Transparent" BorderThickness="0" Cursor="Hand"
                                                        ToolTip="Delete">
                                                    <Path Data="M2,4 L5,4 L5,2 C5,1.45 5.45,1 6,1 L11,1 C11.55,1 12,1.45 12,2 L12,4 L15,4 L15,5 L14,5 L14,15 C14,15.55 13.55,16 13,16 L4,16 C3.45,16 3,15.55 3,15 L3,5 L2,5 L2,4 Z M6,4 L11,4 L11,2.5 L6,2.5 L6,4 Z M4,5 L4,15 L13,15 L13,5 L4,5 Z M5.5,7 L6.5,7 L6.5,13 L5.5,13 L5.5,7 Z M8,7 L9,7 L9,13 L8,13 L8,7 Z M10.5,7 L11.5,7 L11.5,13 L10.5,13 L10.5,7 Z" 
                                                          Fill="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}" 
                                                          Width="15" Height="15" Stretch="Uniform"/>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>

                        <!-- Splitter -->
                        <GridSplitter Grid.Column="1" Width="6" HorizontalAlignment="Center" VerticalAlignment="Stretch"
                                      Background="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowBorderKey}}"/>

                        <!-- Attributes Grid -->
                        <Grid Grid.Column="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Attributes Header -->
                            <Border Grid.Row="0" Style="{StaticResource SectionHeaderBorder}">
                                <Grid>
                                    <TextBlock Text="Attributes" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                    <Button x:Name="btnAddControllerAttribute" ToolTip="Add Attribute" Click="btnAddControllerAttribute_Click" 
                                            Padding="4" HorizontalAlignment="Right" Background="Transparent" BorderThickness="0">
                                        <TextBlock Text="+" FontSize="16" FontWeight="Bold"/>
                                    </Button>
                                </Grid>
                            </Border>

                            <DataGrid Grid.Row="1" 
                                      x:Name="grdControllerAttributes"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      CanUserResizeRows="False"
                                      HeadersVisibility="None"
                                      GridLinesVisibility="None"
                                      SelectionMode="Single"
                                      SelectionUnit="FullRow"
                                      BorderThickness="0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Attribute" Width="*" Binding="{Binding Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <DataGridTemplateColumn Header="" Width="40">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Click="btnDeleteControllerAttribute_Click" 
                                                        Background="Transparent" BorderThickness="0" Cursor="Hand"
                                                        ToolTip="Delete">
                                                    <Path Data="M2,4 L5,4 L5,2 C5,1.45 5.45,1 6,1 L11,1 C11.55,1 12,1.45 12,2 L12,4 L15,4 L15,5 L14,5 L14,15 C14,15.55 13.55,16 13,16 L4,16 C3.45,16 3,15.55 3,15 L3,5 L2,5 L2,4 Z M6,4 L11,4 L11,2.5 L6,2.5 L6,4 Z M4,5 L4,15 L13,15 L13,5 L4,5 Z M5.5,7 L6.5,7 L6.5,13 L5.5,13 L5.5,7 Z M8,7 L9,7 L9,13 L8,13 L8,7 Z M10.5,7 L11.5,7 L11.5,13 L10.5,13 L10.5,7 Z" 
                                                          Fill="{DynamicResource {x:Static vsshell:VsBrushes.ToolWindowTextKey}}" 
                                                          Width="15" Height="15" Stretch="Uniform"/>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Grid>
                </TabItem>
            </TabControl>
        </Border>
    </Grid>
</local:UserControlBase>
