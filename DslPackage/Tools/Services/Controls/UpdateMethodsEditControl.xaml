<local:UserControlBase x:Class="Dyvenix.GenIt.DslPackage.Tools.Services.Controls.UpdateMethodsEditControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Dyvenix.GenIt.DslPackage.Tools.Services.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="1000">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" MinWidth="300"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*" MinWidth="200"/>
        </Grid.ColumnDefinitions>

        <!-- Left Panel - Methods Grid -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Toolbar -->
            <Border Grid.Row="0" Background="{DynamicResource Theme.Background.ToolBar}" Padding="2">
                <Grid>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                        <Button x:Name="btnAdd" ToolTip="Add Method" Click="btnAdd_Click" Padding="4" Background="Transparent" BorderThickness="0">
                            <TextBlock Text="+" FontSize="16" FontWeight="Bold"/>
                        </Button>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button x:Name="btnUp" ToolTip="Move Up" Click="btnUp_Click" Padding="4" Background="Transparent" BorderThickness="0">
                            <Path Data="M0,6 L6,0 L12,6" Stroke="{DynamicResource Theme.Foreground}" StrokeThickness="2" 
                                  Width="12" Height="8" Stretch="Uniform"/>
                        </Button>
                        <Button x:Name="btnDown" ToolTip="Move Down" Click="btnDown_Click" Padding="4" Margin="2,0,0,0" Background="Transparent" BorderThickness="0">
                            <Path Data="M0,0 L6,6 L12,0" Stroke="{DynamicResource Theme.Foreground}" StrokeThickness="2" 
                                  Width="12" Height="8" Stretch="Uniform"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Methods DataGrid -->
            <DataGrid Grid.Row="1" 
                      x:Name="grdMethods"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserResizeRows="False"
                      HeadersVisibility="Column"
                      GridLinesVisibility="None"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      BorderThickness="0"
                      Background="{DynamicResource Theme.DataGrid.Background}"
                      RowBackground="{DynamicResource Theme.DataGrid.RowBackground}"
                      AlternatingRowBackground="{DynamicResource Theme.DataGrid.AlternatingRowBackground}"
                      SelectionChanged="grdMethods_SelectionChanged">
                <DataGrid.Resources>
                    <!-- Keep selection highlighting when DataGrid loses focus -->
                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightBrushKey}" 
                                     Color="{x:Static SystemColors.HighlightColor}"/>
                    <SolidColorBrush x:Key="{x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}" 
                                     Color="{x:Static SystemColors.HighlightTextColor}"/>
                    <!-- Centered column header style -->
                    <Style x:Key="CenteredColumnHeaderStyle" TargetType="DataGridColumnHeader">
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                    </Style>
                </DataGrid.Resources>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Name" Width="*" Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MinWidth="100"/>
                    <DataGridTemplateColumn Header="Use DTO" Width="80" HeaderStyle="{StaticResource CenteredColumnHeaderStyle}">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <CheckBox IsChecked="{Binding UseDto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                          HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Header="" Width="40">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Click="btnDelete_Click" 
                                        Background="Transparent" BorderThickness="0" Cursor="Hand"
                                        ToolTip="Delete">
                                    <Path Data="M2,4 L5,4 L5,2 C5,1.45 5.45,1 6,1 L11,1 C11.55,1 12,1.45 12,2 L12,4 L15,4 L15,5 L14,5 L14,15 C14,15.55 13.55,16 13,16 L4,16 C3.45,16 3,15.55 3,15 L3,5 L2,5 L2,4 Z M6,4 L11,4 L11,2.5 L6,2.5 L6,4 Z M4,5 L4,15 L13,15 L13,5 L4,5 Z M5.5,7 L6.5,7 L6.5,13 L5.5,13 L5.5,7 Z M8,7 L9,7 L9,13 L8,13 L8,7 Z M10.5,7 L11.5,7 L11.5,13 L10.5,13 L10.5,7 Z" 
                                          Fill="{DynamicResource Theme.Foreground}" 
                                          Width="15" Height="15" Stretch="Uniform"/>
                                </Button>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

        <!-- Splitter -->
        <GridSplitter Grid.Column="1" Width="6" HorizontalAlignment="Center" VerticalAlignment="Stretch"
                      Background="{DynamicResource Theme.Splitter}"/>

        <!-- Right Panel - Update Properties -->
        <local:UpdPropsEditControl Grid.Column="2" x:Name="updPropsEditCtl"/>
    </Grid>
</local:UserControlBase>
